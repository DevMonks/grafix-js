<!doctype html>
<html lang="en">
    <head>
        <title>Grafix.js - Demo</title>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.2/css/bootstrap.min.css">
    </head>
    <body style="padding: 40px">

        <div>

            <div class="alert alert-info" style="margin-bottom: 40px">
                <strong>Debug Output:</strong>
                <pre id="debug"></pre>
            </div>

            <div class="well well-small">
                <canvas id="layer" width="700px" height="400px"></canvas>
            </div>

        </div>

        <script src="js/grafix.nocache.js"></script>
        <script>

            Grafix.import();

            var scene = new Scene( '#layer' );
            scene.color = Color.grey;

            var rect = new Rectangle( { width: 100, height: 100, color: Color.yellow } );
            scene.addChild( rect );

            var rect2 = new Rectangle( { width: 40, height: 40, color: Color.red } );
            rect.addChild( rect2 );
            rect.alignBy( scene );
            rect2.alignBy( rect );

            var frameCount = 0,
                wasEverDirty = false,
                $debug = document.getElementById( 'debug' ),
                moveBack = false,
                moveDown = false;

            scene
                .beforeDraw( function () {
                     if ( scene.isDirty ) {
                         wasEverDirty = true;
                     }
                     $debug.innerHTML =
                         'Scene.isDirty: ' + scene.isDirty + ' (was ever: ' + wasEverDirty + ')<br>' +
                         'Frame Count: ' + ( ++frameCount ) + ', last Fps:' + scene.lastFps + '<br>' +
                         'scene: ' + scene + '<br>' +
                         'rect: ' + rect + '<br>' +
                         'rect2: ' + rect2 + '<br>';
                 } )
                .update( function() {
                     // Simple tween to test draw() delegation
                     // Every change to a shape should delegate up to the parent shape (Scene) and forcing a redraw
                     // of the most parent
                     if (!moveBack && (rect.x + 1 + rect.width) < scene.width) {
                        rect.x++;
                     } else {
                         moveBack = true;
                         if (rect.x > 0) {
                             rect.x--;
                         } else {
                             moveBack = false;
                         }
                     }

                     if (!moveDown && (rect.y + 1 + rect.height) < scene.height) {
                         rect.y++;
                     } else {
                         moveDown = true;
                         if (rect.y > 0) {
                             rect.y--;
                         } else {
                             moveDown = false;
                         }
                     }

                     rect2.alignBy(rect);
                 } )
                .start( true );

        </script>

    </body>
</html>
